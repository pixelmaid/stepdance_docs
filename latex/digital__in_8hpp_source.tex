\doxysection{digital\+\_\+in.\+hpp}
\hypertarget{digital__in_8hpp_source}{}\label{digital__in_8hpp_source}\index{lib/digital\_in.hpp@{lib/digital\_in.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ "{}core.hpp"{}}}
\DoxyCodeLine{00003\ \textcolor{comment}{/*}}
\DoxyCodeLine{00004\ \textcolor{comment}{Digital\ Input\ Module\ of\ the\ StepDance\ Control\ System}}
\DoxyCodeLine{00005\ \textcolor{comment}{}}
\DoxyCodeLine{00006\ \textcolor{comment}{This\ module\ is\ responsible\ for\ providing\ an\ interface\ to\ digital\ inputs,\ e.g.\ as\ buttons.}}
\DoxyCodeLine{00007\ \textcolor{comment}{}}
\DoxyCodeLine{00008\ \textcolor{comment}{[More\ Details\ to\ be\ Added]}}
\DoxyCodeLine{00009\ \textcolor{comment}{}}
\DoxyCodeLine{00010\ \textcolor{comment}{A\ part\ of\ the\ Mixing\ Metaphors\ Project}}
\DoxyCodeLine{00011\ \textcolor{comment}{(c)\ 2025\ Ilan\ Moyer,\ Jennifer\ Jacobs,\ Devon\ Frost}}
\DoxyCodeLine{00012\ \textcolor{comment}{}}
\DoxyCodeLine{00013\ \textcolor{comment}{*/}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#ifndef\ digital\_in\_h\ }\textcolor{comment}{//prevent\ importing\ twice}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ digital\_in\_h}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#define\ DIGITAL\_IN\_DEFAULT\_DEBOUNCE\_MS\ \ 50}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ MAX\_NUM\_BUTTONS\ 20}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{comment}{//\ Button\ Mode}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#define\ BUTTON\_MODE\_STANDARD\ 0\ }\textcolor{comment}{//\ button\ state\ reflects\ pin\ state,\ modulo\ debounce\ and\ invert\ flag}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#define\ BUTTON\_MODE\_TOGGLE\ 1\ }\textcolor{comment}{//\ button\ state\ toggles\ each\ button\ press}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#define\ BUTTON\_NON\_INVERTED\ 0}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#define\ BUTTON\_INVERTED\ 1}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#define\ BUTTON\_STATE\_RELEASED\ 0}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ BUTTON\_STATE\_PRESSED\ 1}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ BUTTON\_CHANGED\ 1}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }ButtonKilohertzPlugin\ :\ \textcolor{keyword}{public}\ Plugin\{\ \textcolor{comment}{//we'll\ set\ up\ to\ run\ on\ every\ kilohertz\ frame}}
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \ \ ButtonKilohertzPlugin();}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{void}\ begin();}
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{void}\ run();}
\DoxyCodeLine{00037\ \};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{keyword}{class\ }Button\{}
\DoxyCodeLine{00040\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00041\ \ \ \ \ Button();}
\DoxyCodeLine{00042\ \ \ \ \ uint8\_t\ read();\ \textcolor{comment}{//returns\ button\ state}}
\DoxyCodeLine{00043\ \ \ \ \ uint8\_t\ read\_raw();\ \textcolor{comment}{//returns\ the\ asynchronous\ raw\ state\ of\ the\ input\ pin}}
\DoxyCodeLine{00044\ \ \ \ \ uint8\_t\ has\_changed();\ \textcolor{comment}{//returns\ 1\ if\ the\ button\ state\ has\ changed}}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_callback\_on\_toggle(\textcolor{keywordtype}{void}\ (*callback\_function)());}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_callback\_on\_press(\textcolor{keywordtype}{void}\ (*callback\_function)());}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_callback\_on\_release(\textcolor{keywordtype}{void}\ (*callback\_function)());}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_debounce\_ms(uint16\_t\ debounce\_ms);}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{void}\ begin(uint8\_t\ pin);\ \textcolor{comment}{//defaults\ to\ INPUT\_PULLUP}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{void}\ begin(uint8\_t\ pin,\ uint8\_t\ mode);}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_mode(uint8\_t\ button\_mode);\ \textcolor{comment}{//standard,\ or\ toggle}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ on\_frame();\ \textcolor{comment}{//gets\ called\ at\ each\ kilohertz\ frame}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{void}\ set\_invert();\ \textcolor{comment}{//inverts\ the\ button\ state}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keywordtype}{void}\ clear\_invert();\ \textcolor{comment}{//clears\ the\ invert\ button\ mode}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{static}\ Button*\ registered\_buttons[MAX\_NUM\_BUTTONS];\ \textcolor{comment}{//stores\ all\ registered\ buttons}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{static}\ uint8\_t\ num\_registered\_buttons;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{class_button_kilohertz_plugin}{ButtonKilohertzPlugin}}\ kilohertz\_plugin;\ \textcolor{comment}{//\ runs\ in\ the\ kilohertz\ frame}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00060\ \ \ \ \ uint8\_t\ input\_pin;}
\DoxyCodeLine{00061\ \ \ \ \ uint8\_t\ invert\ =\ BUTTON\_NON\_INVERTED;}
\DoxyCodeLine{00062\ \ \ \ \ uint16\_t\ debounce\_period\_ms\ =\ DIGITAL\_IN\_DEFAULT\_DEBOUNCE\_MS;}
\DoxyCodeLine{00063\ \ \ \ \ uint8\_t\ button\_mode\ =\ BUTTON\_MODE\_STANDARD;}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{volatile}\ uint16\_t\ debounce\_blackout\_remaining\_ms\ =\ 0;\ \textcolor{comment}{//starts\ at\ debounce\_period\_ms,\ and\ counts\ down\ to\ zero}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{volatile}\ uint8\_t\ button\_state\ =\ 0;}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{volatile}\ uint8\_t\ change\_flag\ =\ 0;\ \textcolor{comment}{//set\ when\ the\ button\ state\ changes,\ unless\ a\ callback\ is\ provided}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{volatile}\ uint8\_t\ last\_raw\_pin\_state\ =\ 0;}
\DoxyCodeLine{00068\ \ \ \ \ void\ (*callback\_on\_toggle)()\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00069\ \ \ \ \ void\ (*callback\_on\_press)()\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00070\ \ \ \ \ void\ (*callback\_on\_release)()\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00071\ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//digital\_in\_h}}

\end{DoxyCode}
